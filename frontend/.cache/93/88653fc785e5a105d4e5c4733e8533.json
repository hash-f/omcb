{"id":"node_modules/react-use-websocket/dist/lib/use-event-source.js","dependencies":[{"name":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/use-event-source.js.map","includedInParent":true,"mtime":1732535186175},{"name":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/src/lib/use-event-source.ts","includedInParent":true,"mtime":1732535186180},{"name":"/Users/h/Developer/go-by-example/omcb/frontend/package.json","includedInParent":true,"mtime":1732535186185},{"name":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/package.json","includedInParent":true,"mtime":1732535186173},{"name":"react","loc":{"line":26,"column":22,"index":1006},"parent":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/use-event-source.js","resolved":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react/index.js"},{"name":"./use-websocket","loc":{"line":27,"column":30,"index":1046},"parent":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/use-event-source.js","resolved":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/use-websocket.js"},{"name":"./constants","loc":{"line":28,"column":26,"index":1092},"parent":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/use-event-source.js","resolved":"/Users/h/Developer/go-by-example/omcb/frontend/node_modules/react-use-websocket/dist/lib/constants.js"}],"generated":{"js":"\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useEventSource = void 0;\nvar react_1 = require(\"react\");\nvar use_websocket_1 = require(\"./use-websocket\");\nvar constants_1 = require(\"./constants\");\nvar useEventSource = function (url, _a, connect) {\n    if (_a === void 0) { _a = constants_1.DEFAULT_EVENT_SOURCE_OPTIONS; }\n    var withCredentials = _a.withCredentials, events = _a.events, options = __rest(_a, [\"withCredentials\", \"events\"]);\n    if (connect === void 0) { connect = true; }\n    var optionsWithEventSource = __assign(__assign({}, options), { eventSourceOptions: {\n            withCredentials: withCredentials,\n        } });\n    var eventsRef = (0, react_1.useRef)(constants_1.EMPTY_EVENT_HANDLERS);\n    if (events) {\n        eventsRef.current = events;\n    }\n    var _b = (0, use_websocket_1.useWebSocket)(url, optionsWithEventSource, connect), lastMessage = _b.lastMessage, readyState = _b.readyState, getWebSocket = _b.getWebSocket;\n    (0, react_1.useEffect)(function () {\n        if (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.type) {\n            Object.entries(eventsRef.current).forEach(function (_a) {\n                var type = _a[0], handler = _a[1];\n                if (type === lastMessage.type) {\n                    handler(lastMessage);\n                }\n            });\n        }\n    }, [lastMessage]);\n    return {\n        lastEvent: lastMessage,\n        readyState: readyState,\n        getEventSource: getWebSocket,\n    };\n};\nexports.useEventSource = useEventSource;\n"},"sourceMaps":{"js":{"version":3,"file":"use-event-source.js","sourceRoot":"","sources":["../../src/lib/use-event-source.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+BAAyC;AACzC,iDAA8C;AAC9C,yCAAgF;AAGzE,IAAM,cAAc,GAAG,UAC5B,GAAqD,EACrD,EAA0F,EAC1F,OAAuB;IADvB,mBAAA,EAAA,KAA8D,wCAA4B;IAAxF,IAAA,eAAe,qBAAA,EAAE,MAAM,YAAA,EAAK,OAAO,cAArC,6BAAuC,CAAF;IACrC,wBAAA,EAAA,cAAuB;IAEvB,IAAM,sBAAsB,yBACrB,OAAO,KACV,kBAAkB,EAAE;YAClB,eAAe,iBAAA;SAChB,GACJ,CAAC;IACF,IAAM,SAAS,GAAG,IAAA,cAAM,EAA2B,gCAAoB,CAAC,CAAC;IACzE,IAAI,MAAM,EAAE,CAAC;QACX,SAAS,CAAC,OAAO,GAAG,MAAM,CAAA;IAC5B,CAAC;IAEK,IAAA,KAIF,IAAA,4BAAY,EACd,GAAG,EACH,sBAAsB,EACtB,OAAO,CACR,EAPC,WAAW,iBAAA,EACX,UAAU,gBAAA,EACV,YAAY,kBAKb,CAAC;IAEF,IAAA,iBAAS,EAAC;QACR,IAAI,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,IAAI,EAAE,CAAC;YACpB,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAC,EAAe;oBAAd,IAAI,QAAA,EAAE,OAAO,QAAA;gBACrD,IAAI,IAAI,KAAK,WAAW,CAAC,IAAI,EAAE,CAAC;oBAC5B,OAAO,CAAC,WAAW,CAAC,CAAC;gBACzB,CAAC;YACL,CAAC,CAAC,CAAC;QACP,CAAC;IACH,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;IAElB,OAAO;QACL,SAAS,EAAE,WAAW;QACtB,UAAU,YAAA;QACV,cAAc,EAAE,YAAY;KAC7B,CAAC;AACJ,CAAC,CAAA;AAzCY,QAAA,cAAc,kBAyC1B","sourcesContent":["import { useEffect, useRef } from 'react'\nimport { useWebSocket } from './use-websocket'\nimport { DEFAULT_EVENT_SOURCE_OPTIONS, EMPTY_EVENT_HANDLERS } from './constants'\nimport { EventSourceOptions, Options, EventSourceHook, EventSourceEventHandlers } from './types';\n\nexport const useEventSource = (\n  url: string | (() => string | Promise<string>) | null,\n  { withCredentials, events, ...options }: EventSourceOptions = DEFAULT_EVENT_SOURCE_OPTIONS,\n  connect: boolean = true,\n): EventSourceHook => {\n  const optionsWithEventSource: Options = {\n      ...options,\n      eventSourceOptions: {\n        withCredentials,\n      }\n  };\n  const eventsRef = useRef<EventSourceEventHandlers>(EMPTY_EVENT_HANDLERS);\n  if (events) {\n    eventsRef.current = events\n  }\n\n  const {\n    lastMessage,\n    readyState,\n    getWebSocket,\n  } = useWebSocket(\n    url,\n    optionsWithEventSource,\n    connect,\n  );\n\n  useEffect(() => {\n    if (lastMessage?.type) {\n        Object.entries(eventsRef.current).forEach(([type, handler]) => {\n            if (type === lastMessage.type) {\n                handler(lastMessage);\n            }\n        });\n    }\n  }, [lastMessage]);\n\n  return {\n    lastEvent: lastMessage,\n    readyState,\n    getEventSource: getWebSocket,\n  };\n}\n"]}},"error":null,"hash":"5e4f0ba863b8fe61e207e14cea1dd928","cacheData":{"env":{}}}